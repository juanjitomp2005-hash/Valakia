{% load static %}
{% load i18n %}
<!doctype html>
<html lang="{{ request.LANGUAGE_CODE|default:'en' }}">
<head>
 <meta charset="utf-8" />
 <meta name="viewport" content="width=device-width, initial-scale=1" />
 <script src="https://cdn.tailwindcss.com"></script>
 <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet"
crossorigin="anonymous" />
 <link href="{% static 'pages/app.css' %}" rel="stylesheet" />

</head>
<body>
  <!-- Línea superior de promoción -->
  <div class="bg-red-900">
    <p class="flex h-10 items-center justify-center px-4 text-sm font-medium text-white sm:px-6 lg:px-8">{% trans "Free shipping on orders over $100!" %}</p>
  </div>
  <!-- header -->
  <nav class="bg-white border-b border-gray-200">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex justify-between h-16 items-center">
        <!-- Logo -->
        <div class="flex-shrink-0 flex items-center">
          <a href="{% url 'home' %}" class="flex items-center">
            <img class="h-10 w-10 rounded-full mr-2" src="{% static 'pages/img/valakia.jpeg' %}" alt="Logo Valakia">
            <span class="font-bold text-xl text-gray-800">Valakia</span>
          </a>
        </div>
        <!-- Desktop menu -->
        <div class="hidden lg:flex space-x-8">
          <a href="{% url 'home' %}" class="text-gray-900 hover:text-red-900 px-3 py-2 rounded-md text-sm font-medium {% if request.resolver_match.url_name == 'home' %}border-b-2 border-red-900{% endif %}">{% trans "Home" %}</a>
          <a href="{% url 'about' %}" class="text-gray-900 hover:text-red-900 px-3 py-2 rounded-md text-sm font-medium {% if request.resolver_match.url_name == 'about' %}border-b-2 border-red-900{% endif %}">{% trans "About" %}</a>
          <a href="{% url 'products' %}" class="text-gray-900 hover:text-red-900 px-3 py-2 rounded-md text-sm font-medium {% if request.resolver_match.url_name == 'products' %}border-b-2 border-red-900{% endif %}">{% trans "Products" %}</a>
        </div>
        <!-- Auth buttons -->
        <div class="hidden lg:flex items-center space-x-6">
          <!-- Language switcher -->
          <form action="{% url 'set_language' %}" method="post" class="flex items-center">
            {% csrf_token %}
            <select name="language" onchange="this.form.submit()" class="form-select form-select-sm mr-3">
              <option value="en" {% if request.LANGUAGE_CODE == 'en' %}selected{% endif %}>English</option>
              <option value="es" {% if request.LANGUAGE_CODE == 'es' %}selected{% endif %}>Español</option>
            </select>
            <input type="hidden" name="next" value="{{ request.path }}" />
          </form>
          {% if user.is_authenticated %}
            <a href="{% url 'cart' %}" class="block px-3 py-2 rounded-md text-base font-medium text-gray-900 hover:text-red-900">
              {% trans "Cart" %}
              {% if cart_count and cart_count > 0 %}
                <span class="ml-1 inline-block bg-red-600 text-white text-xs font-bold px-2 py-0.5 rounded-full align-top cart-count-badge">{{ cart_count }}</span>
              {% else %}
                <span class="ml-1 inline-block bg-red-600 text-white text-xs font-bold px-2 py-0.5 rounded-full align-top cart-count-badge" style="display:none;">0</span>
              {% endif %}
            </a>
            <a href="{% url 'orders_list' %}" class="text-gray-900 hover:text-red-900 px-3 py-2 rounded-md text-sm font-medium">{% trans "Orders" %}</a>
            <span class="h-6 w-px bg-gray-200 mx-2"></span>
            <span class="ml-2 px-3 py-1 rounded-full bg-red-900 text-white text-sm font-semibold">{{ user.username }}</span>
            <form action="{% url 'logout' %}" method="post" class="flex items-center ml-2">
              {% csrf_token %}
              <span class="h-6 w-px bg-gray-200 mx-2"></span>
              <button type="submit" class="text-gray-900 hover:text-red-600 px-3 py-2 rounded-md text-sm font-medium">{% trans "Logout" %}</button>
            </form>
          {% else %}
            <a href="{% url 'cart' %}" class="block px-3 py-2 rounded-md text-base font-medium text-gray-900 hover:text-red-900">
              {% trans "Cart" %}
              {% if cart_count and cart_count > 0 %}
                <span class="ml-1 inline-block bg-red-600 text-white text-xs font-bold px-2 py-0.5 rounded-full align-top">{{ cart_count }}</span>
              {% endif %}
            </a>
            <span class="h-6 w-px bg-gray-200"></span>
            <a href="{% url 'login' %}" class="text-gray-900 hover:text-red-900 px-3 py-2 rounded-md text-sm font-medium">{% trans "Login" %}</a>
            <span class="h-6 w-px bg-gray-200"></span>
            <a href="{% url 'register' %}" class="text-gray-900 hover:text-red-900 px-3 py-2 rounded-md text-sm font-medium">{% trans "Register" %}</a>
          {% endif %}
        </div>
        <!-- Mobile menu button -->
        <div class="flex lg:hidden">
          <button type="button" class="inline-flex items-center justify-center p-2 rounded-md text-gray-400 hover:text-gray-500 hover:bg-gray-100 focus:outline-none" aria-controls="mobile-menu" aria-expanded="false" onclick="document.getElementById('mobile-menu').classList.toggle('hidden')">
            <svg class="h-6 w-6" stroke="currentColor" fill="none" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/>
            </svg>
          </button>
        </div>
      </div>
    </div>
    <!-- Mobile menu -->
    <div class="lg:hidden hidden border-t border-gray-200" id="mobile-menu">
      <div class="pt-2 pb-3 space-y-1">
  <a href="{% url 'home' %}" class="block px-3 py-2 rounded-md text-base font-medium text-gray-900 hover:text-red-900 {% if request.resolver_match.url_name == 'home' %}border-l-4 border-red-900 bg-gray-50{% endif %}">{% trans "Home" %}</a>
  <a href="{% url 'about' %}" class="block px-3 py-2 rounded-md text-base font-medium text-gray-900 hover:text-red-900 {% if request.resolver_match.url_name == 'about' %}border-l-4 border-red-900 bg-gray-50{% endif %}">{% trans "About" %}</a>
  <a href="{% url 'products' %}" class="block px-3 py-2 rounded-md text-base font-medium text-gray-900 hover:text-red-900 {% if request.resolver_match.url_name == 'products' %}border-l-4 border-red-900 bg-gray-50{% endif %}">{% trans "Products" %}</a>
        <div class="border-t border-gray-200 mt-2 pt-2">
          {% if user.is_authenticated %}
            <a href="{% url 'cart' %}" class="block px-3 py-2 rounded-md text-base font-medium text-gray-900 hover:text-red-900">{% trans "Cart" %}</a>
            <a href="{% url 'orders_list' %}" class="block px-3 py-2 rounded-md text-base font-medium text-gray-900 hover:text-red-900">{% trans "Orders" %}</a>
            <span class="h-6 w-px bg-gray-200 mx-2"></span>
            <span class="block mt-2 mb-2 px-3 py-1 rounded-full bg-red-900 text-white text-sm font-semibold text-center">{{ user.username }}</span>
            <form action="{% url 'logout' %}" method="post">
              {% csrf_token %}
              <span class="h-6 w-px bg-gray-200"></span>
              <button type="submit" class="block w-full text-left px-3 py-2 rounded-md text-base font-medium text-gray-900 hover:text-red-900">{% trans "Logout" %}</button>
            </form>
          {% else %}
            <a href="{% url 'cart' %}" class="block px-3 py-2 rounded-md text-base font-medium text-gray-900 hover:text-red-900">{% trans "Cart" %}</a>
            <a href="{% url 'login' %}" class="block px-3 py-2 rounded-md text-base font-medium text-gray-900 hover:text-red-900">{% trans "Login" %}</a>
            <a href="{% url 'register' %}" class="block px-3 py-2 rounded-md text-base font-medium text-gray-900 hover:text-red-900">{% trans "Register" %}</a>
          {% endif %}
        </div>
      </div>
    </div>
  </nav>

  <!-- Mensajes flash (Django messages) -->
  {% if messages %}
    <div class="container mt-3">
      {% for message in messages %}
        <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
          {{ message }}
          <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
      {% endfor %}
    </div>
  {% endif %}

  <!-- Contenedor para mensajes inyectados desde JS (peticiones AJAX) -->
  <div id="ajax-messages-container" class="container mt-3"></div>

  <main class="flex-1">
    <div class="container my-4">
      {% block content %}
      {% endblock %}
    </div>
  </main>

  {% block footer %}
  <footer class="bg-red-900 text-white py-4 mt-auto">
    <div class="container mx-auto text-center">
  <small>&copy; {{ year|default:"2025" }} Valakia. {% trans "All rights reserved." %}</small>
    </div>
  </footer>
  {% endblock %}
 <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"
crossorigin="anonymous">
 </script>
</body>
</html>